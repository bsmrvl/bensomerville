"use strict";(function(e,t){"function"==typeof define&&define.amd?define(["./ResizeSensor.js"],t):"object"==typeof exports?module.exports=t(require("./ResizeSensor.js")):(e.ElementQueries=t(e.ResizeSensor),e.ElementQueries.listen())})("undefined"!=typeof window?window:this,function(e){var t=function(){function t(e){e||(e=document.documentElement);var t=window.getComputedStyle(e,null).fontSize;return parseFloat(t)||16}function n(e){if(!e.getBoundingClientRect)return{width:e.offsetWidth,height:e.offsetHeight};var t=e.getBoundingClientRect();return{width:Math.round(t.width),height:Math.round(t.height)}}function i(e,n){var i=n.split(/\d/),r=i[i.length-1];switch(n=parseFloat(n),r){case"px":return n;case"em":return n*t(e);case"rem":return n*t();case"vw":return n*document.documentElement.clientWidth/100;case"vh":return n*document.documentElement.clientHeight/100;case"vmin":case"vmax":var o=document.documentElement.clientWidth/100,s=document.documentElement.clientHeight/100,d=Math["vmin"===r?"min":"max"];return n*d(o,s);default:return n}}function r(e,t){var r,o,s,d,a,l,u,c;this.element=e;var h=["min-width","min-height","max-width","max-height"];this.call=function(){for(r in s=n(this.element),l={},m[t])m[t].hasOwnProperty(r)&&(o=m[t][r],d=i(this.element,o.value),a="width"===o.property?s.width:s.height,c=o.mode+"-"+o.property,u="","min"===o.mode&&a>=d&&(u+=o.value),"max"===o.mode&&a<=d&&(u+=o.value),l[c]||(l[c]=""),u&&-1===(" "+l[c]+" ").indexOf(" "+u+" ")&&(l[c]+=" "+u));for(var e in h)h.hasOwnProperty(e)&&(l[h[e]]?this.element.setAttribute(h[e],l[h[e]].substr(1)):this.element.removeAttribute(h[e]))}}function o(t,n){t.elementQueriesSetupInformation||(t.elementQueriesSetupInformation=new r(t,n)),t.elementQueriesSensor||(t.elementQueriesSensor=new e(t,function(){t.elementQueriesSetupInformation.call()}))}function s(e,t,n,i){if(void 0===m[e]){m[e]=[];var r=p.length;f.innerHTML+="\n"+e+" {animation: 0.1s element-queries;}",f.innerHTML+="\n"+e+" > .resize-sensor {min-width: "+r+"px;}",p.push(e)}m[e].push({mode:t,property:n,value:i})}function d(e){var t;if(document.querySelectorAll&&(t=e?e.querySelectorAll.bind(e):document.querySelectorAll.bind(document)),t||"undefined"==typeof $$||(t=$$),t||"undefined"==typeof jQuery||(t=jQuery),!t)throw"No document.querySelectorAll, jQuery or Mootools's $$ found.";return t}function a(e){var t=d(e);for(var n in m)if(m.hasOwnProperty(n))for(var i=t(n,e),r=0,s=i.length;r<s;r++)o(i[r],n)}function l(t){function n(){var e,n=!1;for(e in i)i.hasOwnProperty(e)&&r[e].minWidth&&t.offsetWidth>r[e].minWidth&&(n=e);if(n||(n=s),d!==n)if(a[n])i[d].style.display="none",i[n].style.display="block",d=n;else{var l=new Image;l.onload=function(){i[n].src=o[n],i[d].style.display="none",i[n].style.display="block",a[n]=!0,d=n},l.src=o[n]}else i[n].src=o[n]}var i=[],r=[],o=[],s=0,d=-1,a=[];for(var l in t.children)if(t.children.hasOwnProperty(l)&&t.children[l].tagName&&"img"===t.children[l].tagName.toLowerCase()){i.push(t.children[l]);var u=t.children[l].getAttribute("min-width")||t.children[l].getAttribute("data-min-width"),c=t.children[l].getAttribute("data-src")||t.children[l].getAttribute("url");o.push(c);var h={minWidth:u};r.push(h),u?t.children[l].style.display="none":(s=i.length-1,t.children[l].style.display="block")}d=s,t.resizeSensorInstance=new e(t,n),n()}function u(){for(var e=d(),t=e("[data-responsive-image],[responsive-image]"),n=0,i=t.length;n<i;n++)l(t[n])}function c(e){var t,n,i,r;for(e=e.replace(/'/g,'"');null!==(t=v.exec(e));)for(n=t[1]+t[3],i=t[2];null!==(r=y.exec(i));)s(n,r[1],r[2],r[3])}function h(e){var t="";if(e)if("string"==typeof e)e=e.toLowerCase(),-1===e.indexOf("min-width")&&-1===e.indexOf("max-width")||c(e);else for(var n=0,i=e.length;n<i;n++)1===e[n].type?(t=e[n].selectorText||e[n].cssText,-1!==t.indexOf("min-height")||-1!==t.indexOf("max-height")?c(t):-1===t.indexOf("min-width")&&-1===t.indexOf("max-width")||c(t)):4===e[n].type?h(e[n].cssRules||e[n].rules):3===e[n].type&&e[n].styleSheet.hasOwnProperty("cssRules")&&h(e[n].styleSheet.cssRules)}var f,m={},p=[],v=/,?[\s\t]*([^,\n]*?)((?:\[[\s\t]*?(?:min|max)-(?:width|height)[\s\t]*?[~$\^]?=[\s\t]*?"[^"]*?"[\s\t]*?])+)([^,\n\s\{]*)/gim,y=/\[[\s\t]*?(min|max)-(width|height)[\s\t]*?[~$\^]?=[\s\t]*?"([^"]*?)"[\s\t]*?]/gim,g=!1;this.init=function(){var t="animationstart";void 0!==document.documentElement.style.webkitAnimationName?t="webkitAnimationStart":void 0!==document.documentElement.style.MozAnimationName?t="mozanimationstart":void 0!==document.documentElement.style.OAnimationName&&(t="oanimationstart"),document.body.addEventListener(t,function(t){var n=t.target,i=n&&window.getComputedStyle(n,null),r=i&&i.getPropertyValue("animation-name"),s=r&&-1!==r.indexOf("element-queries");if(s){n.elementQueriesSensor=new e(n,function(){n.elementQueriesSetupInformation&&n.elementQueriesSetupInformation.call()});var d=window.getComputedStyle(n.resizeSensor,null),a=d.getPropertyValue("min-width");a=parseInt(a.replace("px","")),o(t.target,p[a])}}),g||(f=document.createElement("style"),f.type="text/css",f.innerHTML="[responsive-image] > img, [data-responsive-image] {overflow: hidden; padding: 0; } [responsive-image] > img, [data-responsive-image] > img {width: 100%;}",f.innerHTML+="\n@keyframes element-queries { 0% { visibility: inherit; } }",document.getElementsByTagName("head")[0].appendChild(f),g=!0);for(var n=0,i=document.styleSheets.length;n<i;n++)try{document.styleSheets[n].href&&0===document.styleSheets[n].href.indexOf("file://")&&console.warn("CssElementQueries: unable to parse local css files, "+document.styleSheets[n].href),h(document.styleSheets[n].cssRules||document.styleSheets[n].rules||document.styleSheets[n].cssText)}catch(e){}u()},this.findElementQueriesElements=function(e){a(e)},this.update=function(){this.init()}};t.update=function(){t.instance.update()},t.detach=function(e){e.elementQueriesSetupInformation?(e.elementQueriesSensor.detach(),delete e.elementQueriesSetupInformation,delete e.elementQueriesSensor):e.resizeSensorInstance&&(e.resizeSensorInstance.detach(),delete e.resizeSensorInstance)},t.init=function(){t.instance||(t.instance=new t),t.instance.init()};var n=function(e){if(document.addEventListener)document.addEventListener("DOMContentLoaded",e,!1);else if(/KHTML|WebKit|iCab/i.test(navigator.userAgent))var t=setInterval(function(){/loaded|complete/i.test(document.readyState)&&(e(),clearInterval(t))},10);else window.onload=e};return t.findElementQueriesElements=function(e){t.instance.findElementQueriesElements(e)},t.listen=function(){n(t.init)},t}),function(e,t){"function"==typeof define&&define.amd?define(t):"object"==typeof exports?module.exports=t():e.ResizeSensor=t()}("undefined"!=typeof window?window:this,function(){function e(e,t){var n=Object.prototype.toString.call(e),i="[object Array]"===n||"[object NodeList]"===n||"[object HTMLCollection]"===n||"[object Object]"===n||"undefined"!=typeof jQuery&&e instanceof jQuery||"undefined"!=typeof Elements&&e instanceof Elements,r=0,o=e.length;if(i)for(;r<o;r++)t(e[r]);else t(e)}function t(e){if(!e.getBoundingClientRect)return{width:e.offsetWidth,height:e.offsetHeight};var t=e.getBoundingClientRect();return{width:Math.round(t.width),height:Math.round(t.height)}}function n(e,t){Object.keys(t).forEach(function(n){e.style[n]=t[n]})}if("undefined"==typeof window)return null;var i="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")(),r=i.requestAnimationFrame||i.mozRequestAnimationFrame||i.webkitRequestAnimationFrame||function(e){return i.setTimeout(e,20)},o=function(i,s){function d(){var e,t,n=[];this.add=function(e){n.push(e)},this.call=function(i){for(e=0,t=n.length;e<t;e++)n[e].call(this,i)},this.remove=function(i){var r=[];for(e=0,t=n.length;e<t;e++)n[e]!==i&&r.push(n[e]);n=r},this.length=function(){return n.length}}function a(e,i){if(e)if(e.resizedAttached)e.resizedAttached.add(i);else{e.resizedAttached=new d,e.resizedAttached.add(i),e.resizeSensor=document.createElement("div"),e.resizeSensor.dir="ltr",e.resizeSensor.className="resize-sensor";var o={pointerEvents:"none",position:"absolute",left:"0px",top:"0px",right:"0px",bottom:"0px",overflow:"hidden",zIndex:"-1",visibility:"hidden",maxWidth:"100%"},s={position:"absolute",left:"0px",top:"0px",transition:"0s"};n(e.resizeSensor,o);var a=document.createElement("div");a.className="resize-sensor-expand",n(a,o);var l=document.createElement("div");n(l,s),a.appendChild(l);var u=document.createElement("div");u.className="resize-sensor-shrink",n(u,o);var c=document.createElement("div");n(c,s),n(c,{width:"200%",height:"200%"}),u.appendChild(c),e.resizeSensor.appendChild(a),e.resizeSensor.appendChild(u),e.appendChild(e.resizeSensor);var h,f,m=window.getComputedStyle(e),p=m?m.getPropertyValue("position"):null;"absolute"!==p&&"relative"!==p&&"fixed"!==p&&(e.style.position="relative");var v=t(e),y=0,g=0,w=!0,S=0,x=function(){var t=e.offsetWidth,n=e.offsetHeight;l.style.width=t+10+"px",l.style.height=n+10+"px",a.scrollLeft=t+10,a.scrollTop=n+10,u.scrollLeft=t+10,u.scrollTop=n+10},z=function(){if(w){var t=0===e.offsetWidth&&0===e.offsetHeight;if(t)return void(S||(S=r(function(){S=0,z()})));w=!1}x()};e.resizeSensor.resetSensor=z;var b=function(){f=0,h&&(y=v.width,g=v.height,e.resizedAttached&&e.resizedAttached.call(v))},E=function(){v=t(e),h=v.width!==y||v.height!==g,h&&!f&&(f=r(b)),z()},A=function(e,t,n){e.attachEvent?e.attachEvent("on"+t,n):e.addEventListener(t,n)};A(a,"scroll",E),A(u,"scroll",E),r(z)}}e(i,function(e){a(e,s)}),this.detach=function(e){o.detach(i,e)},this.reset=function(){i.resizeSensor.resetSensor()}};if(o.reset=function(t){e(t,function(e){e.resizeSensor.resetSensor()})},o.detach=function(t,n){e(t,function(e){e&&(e.resizedAttached&&"function"==typeof n&&(e.resizedAttached.remove(n),e.resizedAttached.length())||e.resizeSensor&&(e.contains(e.resizeSensor)&&e.removeChild(e.resizeSensor),delete e.resizeSensor,delete e.resizedAttached))})},"undefined"!=typeof MutationObserver){var s=new MutationObserver(function(e){for(var t in e)if(e.hasOwnProperty(t))for(var n=e[t].addedNodes,i=0;i<n.length;i++)n[i].resizeSensor&&o.reset(n[i])});document.addEventListener("DOMContentLoaded",function(e){s.observe(document.body,{childList:!0,subtree:!0})})}return o});